import csv
import pandas as pd
import numpy as np
import math
'''
LOAD = [1.0 ,0.9979161995715697 ,0.9973039321013215 ,0.9947960804863331 ,0.9904808490423999 ,0.9861952341030674 ,0.9861421309704715 ,0.9851562699031806 ,
0.9833717315042246 ,0.9827173943489078 ,0.9784239075313886 ,0.9774206893823454 ,0.9776178100922863 ,0.9803403971817356 ,0.9812303112267905 ,0.9777049172741447 ,
0.9797363887745505 ,0.9796463778713005 ,0.9752355220041345 ,0.9738115434096201 ,0.9706741318285041 ,0.9713521492042545 ,0.973877357735814 ,0.9703441564908545 ,
0.9696890449657849 ,0.9681563435695633 ,0.966079576228875 ,0.9630768261932849 ,0.9648010992001567 ,0.968648015834951 ,0.9671027322516964 ,0.9654737610690542 ,
0.9622209807833656 ,0.9588387008665658 ,0.9588585741544707 ,0.9572532187715701 ,0.9536814321750672 ,0.9506477750736823 ,0.9469129364023738 ,0.9440976282807211 ,
0.9425325358302533 ,0.9386022541950746 ,0.9373221640061589 ,0.9358200469115476 ,0.9333600075081756 ,0.9316163774048402 ,0.9303338996859741 ,0.9328198776679836 ,
0.928231516530833 ,0.9266112560168223 ,0.927417805226674 ,0.927171904508107 ,0.9255660329337649 ,0.9229740421138205 ,0.9204219270414327 ,0.923071344283124 ,
0.9188536084357511 ,0.9175478376813281 ,0.9190304685077294 ,0.9140001184901348  ,0.910001184901348 ]
with open('./LOAD.csv', 'a', newline='') as mycsvfile:
	wr = csv.writer(mycsvfile)
	wr.writerow(LOAD)


PV =  [0.7521766495441423 ,0.7535741696396218 ,0.7548454769185965 ,0.7571540240713919 ,0.7571342055299571 ,0.7572084729062807 ,0.7619505283310222 ,0.7644447439246261 ,
0.765628015156386 ,0.7658595791668327 ,0.767694150255002 ,0.7692005680202592 ,0.7725649218909558 ,0.7732320765805131 ,0.7743894794002951 ,0.7754094041273886 ,0.7760988807530879 ,
0.7781994375289325 ,0.777032229746546 ,0.7788640888237821 ,0.7804572909389003 ,0.7822532680253286 ,0.7818523076396723 ,0.7836816633222009 ,0.7827051307700379 ,0.78386253358982 ,
0.7848006807564675 ,0.7844652258656583 ,0.7859804055123917 ,0.7878890353606589 ,0.7885190563620543 ,0.7941080936628441 ,0.7948424227770533 ,0.7974073592711449 ,0.7966625993456543 ,
0.7989513279570151 ,0.797806233494545 ,0.798515528661679 ,0.798734575698588 ,0.7993856669387718 ,0.7993066013892589 ,0.8013266323020112 ,0.8019405898540333 ,0.8026486333238135 ,
0.8034420008298754 ,0.8050487629996593 ,0.804537444630646 ,0.8035744721331489 ,0.8063459386906119 ,0.8075231600518287 ,0.8089663671007206 ,0.8087051795862348 ,0.8089999543130466 ,
0.8086730526874881 ,0.8097808048455708 ,0.8111895902172341 ,0.8120572250996194 ,0.8141888656930825 ,0.8158586299630061 ,0.8189136059710971,0.8289136059710971 ]
with open('./PV.csv', 'a', newline='') as mycsvfile:
	wr = csv.writer(mycsvfile)
	wr.writerow(PV)

PV = pd.read_csv('./PV.csv')

PV['date'] = pd.to_datetime(PV['date'])
PV_= pd.DataFrame()
PV_['date'] = pd.date_range(start='2021-03-14 00:00:00', end='2021-03-14 06:00:00', freq='MIN')
PV_ = pd.merge(PV_, PV, on='date', how='outer')
PV_ = PV_.interpolate()
PV_.to_csv('PV.csv', index=False)


PV = pd.read_csv('./PV.csv')
PV= PV['pv']
PV = np.array(PV[0:360])
PV = np.transpose(PV)
print(PV)

LOAD = pd.read_csv('./LOAD.csv')
LOAD = LOAD['load']
LOAD = np.array(LOAD[0:360])
LOAD = np.transpose(LOAD)
print(LOAD)

#1초인거 10초로 추출

import csv

filein = open('wakanaiPV.csv', 'r')
csvfilein = csv.reader(filein)
fileout = open('fileout.csv', 'w', newline = '')
csvfileout = csv.writer(fileout)
rowcount = 1

for row in csvfilein:
    if (rowcount-2)%10 == 0:
        csvfileout.writerow(row)
    rowcount += 1


ra = np.random.randint(310)

train = pd.read_csv('./fileout.csv')
pv = np.array(train)
pv = np.transpose(pv)
pv = pv[ra]/5000
print(pv[2880:6380])


LOAD = pd.read_csv('./LOAD.csv')
LOAD = LOAD['load']
LOAD = np.array(LOAD[2880:6380])
LOAD = np.transpose(LOAD)/56934.26172
LOAD = pd.read_csv('./LOAD2.csv')'''

LOAD = pd.read_csv('./aprilload.csv')
LOAD['date'] = pd.to_datetime(LOAD['date'])
LOAD_= pd.DataFrame()
LOAD_['date'] = pd.date_range(start='2021-04-01 00:00:00', end='2021-04-01 23:59:50', freq='10S')
LOAD_ = pd.merge(LOAD_, LOAD, on='date', how='outer')
LOAD_ = LOAD_.interpolate()

LOAD_.to_csv('LOAD.csv', index=False)